<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nms.db.dao.ptn.path.pw.PwInfoMapper" >
  <resultMap id="BaseResultMap" type="PwInfo" >
    <id column="pwId" property="pwId" jdbcType="INTEGER" />
    <result column="pwName" property="pwName" jdbcType="VARCHAR" />
    <result column="pwStatus" property="pwStatus" jdbcType="INTEGER" />
    <result column="tunnelId" property="tunnelId" jdbcType="INTEGER" />
    <result column="inlabelValue" property="inlabelValue" jdbcType="INTEGER" />
    <result column="outlabelValue" property="OutlabelValue" jdbcType="INTEGER" />
    <result column="aSiteId" property="aSiteId" jdbcType="INTEGER" />
    <result column="zSiteId" property="zSiteId" jdbcType="INTEGER" />
   <result column="showaSiteName" property="showaSiteName" jdbcType="VARCHAR" />
   <result column="showzSiteName" property="showzSiteName" jdbcType="VARCHAR" />
    <result column="direction" property="direction" jdbcType="VARCHAR" />
    <result column="createTime" property="createTime" jdbcType="TIMESTAMP" />
    <result column="createUser" property="createUser" jdbcType="VARCHAR" />
    <result column="apwServiceId" property="apwServiceId" jdbcType="INTEGER" />
    <result column="zpwServiceId" property="zpwServiceId" jdbcType="INTEGER" />
    <result column="rserviceId" property="relatedServiceId" jdbcType="INTEGER" />
    <result column="rserviceType" property="relatedServiceType" jdbcType="INTEGER" />
    <result column="aPortConfigId" property="aPortConfigId" jdbcType="INTEGER" />
    <result column="zPortConfigId" property="zPortConfigId" jdbcType="INTEGER" />
    <result column="type" property="type" jdbcType="INTEGER" typeHandler="com.nms.db.enums.IntEnumTypeHandler"/>
    <result column="isSingle" property="isSingle" jdbcType="INTEGER" />
    <result column="aoppositeId" property="aoppositeId" jdbcType="VARCHAR" />
    <result column="zoppositeId" property="zoppositeId" jdbcType="VARCHAR" />
    <result column="jobstatus" property="jobStatus" jdbcType="VARCHAR" />
    <result column="expStrategy" property="expStrategy" jdbcType="INTEGER" />
    <result column="expAssignment" property="expAssignment" jdbcType="INTEGER" />
    <result column="phbToExpId" property="phbToExpId" jdbcType="INTEGER" />
    <result column="phbStrategy" property="phbStrategy" jdbcType="INTEGER" />
    <result column="phbAssignment" property="phbAssignment" jdbcType="INTEGER" />
    <result column="expTophbId" property="expTophbId" jdbcType="INTEGER" />
    <result column="payload" property="payload" jdbcType="INTEGER" />
    <result column="aVlanEnable" property="aVlanEnable" jdbcType="INTEGER" />
    <result column="aOutVlanValue" property="aOutVlanValue" jdbcType="INTEGER" />
    <result column="aSourceMac" property="aSourceMac" jdbcType="VARCHAR" />
    <result column="atargetMac" property="atargetMac" jdbcType="VARCHAR" />
    <result column="zVlanEnable" property="zVlanEnable" jdbcType="INTEGER" />
    <result column="zOutVlanValue" property="zOutVlanValue" jdbcType="INTEGER" />
    <result column="zSourceMac" property="zSourceMac" jdbcType="VARCHAR" />
    <result column="ztargetMac" property="ztargetMac" jdbcType="VARCHAR" />
    <result column="businessType" property="businessType" jdbcType="VARCHAR" />
    <result column="backInlabel" property="backInlabel" jdbcType="INTEGER" />
    <result column="backOutlabel" property="backOutlabel" jdbcType="INTEGER" />
    <result column="atp_id" property="atp_id" jdbcType="INTEGER" />
    <result column="ztp_id" property="ztp_id" jdbcType="INTEGER" />
    <result column="qosModel" property="qosModel" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    pwId, pwName, pwStatus, tunnelId, inlabelValue, outlabelValue, aSiteId, zSiteId, 
    direction, createTime, createUser, apwServiceId, zpwServiceId, rserviceId, rserviceType, 
    aPortConfigId, zPortConfigId, type, isSingle, aoppositeId, zoppositeId, jobstatus, 
    expStrategy, expAssignment, phbToExpId, phbStrategy, phbAssignment, expTophbId, payload, 
    aVlanEnable, aOutVlanValue, aSourceMac, atargetMac, zVlanEnable, zOutVlanValue, zSourceMac, 
    ztargetMac, businessType, backInlabel, backOutlabel, atp_id, ztp_id, pri, qosModel, 
    snmpPwName
  </sql>
  <insert id="insert" useGeneratedKeys="true" keyProperty="pwId">
    insert into pwinfo (pwName, pwStatus, 
      tunnelId, inlabelValue, outlabelValue, 
      aSiteId, zSiteId, direction, 
      createTime, createUser, apwServiceId, 
      zpwServiceId, rserviceId, rserviceType, 
      aPortConfigId, zPortConfigId, type, 
      isSingle, aoppositeId, zoppositeId, 
      jobstatus, expStrategy, expAssignment, 
      phbToExpId, phbStrategy, phbAssignment, 
      expTophbId, payload, aVlanEnable, 
      aOutVlanValue, aSourceMac, atargetMac, 
      zVlanEnable, zOutVlanValue, zSourceMac, 
      ztargetMac, businessType, backInlabel, 
      backOutlabel, atp_id, ztp_id, qosModel
      )
    values (#{pw.pwName,jdbcType=VARCHAR}, #{pw.pwStatus,jdbcType=INTEGER}, 
      #{pw.tunnelId,jdbcType=INTEGER}, #{pw.InlabelValue,jdbcType=INTEGER}, #{pw.OutlabelValue,jdbcType=INTEGER}, 
      #{pw.aSiteId,jdbcType=INTEGER}, #{pw.zSiteId,jdbcType=INTEGER}, #{pw.direction,jdbcType=VARCHAR}, 
      #{pw.createTime,jdbcType=TIMESTAMP}, #{pw.createUser,jdbcType=VARCHAR}, #{pw.apwServiceId,jdbcType=INTEGER}, 
      #{pw.zpwServiceId,jdbcType=INTEGER}, #{pw.relatedServiceId,jdbcType=INTEGER}, #{pw.relatedServiceType,jdbcType=INTEGER}, 
      #{pw.aPortConfigId,jdbcType=INTEGER}, #{pw.zPortConfigId,jdbcType=INTEGER}, #{type,jdbcType=INTEGER}, 
      #{pw.isSingle,jdbcType=INTEGER}, #{pw.aoppositeId,jdbcType=VARCHAR}, #{pw.zoppositeId,jdbcType=VARCHAR}, 
      #{pw.jobStatus,jdbcType=VARCHAR}, #{pw.expStrategy,jdbcType=INTEGER}, #{pw.expAssignment,jdbcType=INTEGER}, 
      #{pw.phbToExpId,jdbcType=INTEGER}, #{pw.phbStrategy,jdbcType=INTEGER}, #{pw.phbAssignment,jdbcType=INTEGER}, 
      #{pw.expTophbId,jdbcType=INTEGER}, #{pw.payload,jdbcType=INTEGER}, #{pw.aVlanEnable,jdbcType=INTEGER}, 
      #{pw.aOutVlanValue,jdbcType=INTEGER}, #{pw.aSourceMac,jdbcType=VARCHAR}, #{pw.atargetMac,jdbcType=VARCHAR}, 
      #{pw.zVlanEnable,jdbcType=INTEGER}, #{pw.zOutVlanValue,jdbcType=INTEGER}, #{pw.zSourceMac,jdbcType=VARCHAR}, 
      #{pw.ztargetMac,jdbcType=VARCHAR}, #{pw.businessType,jdbcType=VARCHAR}, #{pw.backInlabel,jdbcType=INTEGER}, 
      #{pw.backOutlabel,jdbcType=INTEGER}, #{pw.atp_id,jdbcType=INTEGER}, #{pw.ztp_id,jdbcType=INTEGER}, 
      #{pw.qosModel,jdbcType=INTEGER}
      )
  </insert>
  <update id="updateTunnelID" parameterType="map">
  	update pwinfo set tunnelId=#{newTunnelId} where tunnelId in 
		<foreach item="item" index="index" collection="ids" open="(" separator="," close=")">  
 		 #{item}  
 		</foreach>
  </update>
  <select id="queryByCondition" resultMap="BaseResultMap" >
  SELECT p.qosModel,p.atp_id,p.ztp_id,p.businessType,p.backInlabel,p.backOutlabel,p.ztargetMac,p.zSourceMac,p.zOutVlanValue,
  p.zVlanEnable,p.atargetMac,p.aSourceMac,p.aOutVlanValue,p.aVlanEnable,p.expStrategy,p.expAssignment,p.phbToExpId,
  p.phbStrategy,p.phbAssignment,p.expTophbId,p.jobstatus,p.aoppositeId,p.zoppositeId,p.isSingle, p.pwId, p.pwName, 
  p.pwStatus, p.tunnelId,p.aSiteId,p.zSiteId, p.type, p.inlabelValue, p.outlabelValue,p.apwServiceId,p.zpwServiceId,
  sa.CellId AS showaSiteName, sz.CellId AS showzSiteName, p.direction, p.createTime, p.createUser,p.rserviceId,
  p.rserviceType,p.aPortConfigId,p.zPortConfigId,p.payload FROM pwinfo p, site_inst sa, site_inst sz 
  WHERE p.aSiteId = sa.site_inst_id AND p.zSiteId = sz.site_inst_id and p.issingle=0
  <if test="pwInfo.pwId > 0">
  and pwId=#{pwInfo.pwId}
  </if>
  <if test="type > 0">
  and p.type=#{type}
  </if>
  <if test="pwInfo.aSiteId > 0">
  and p.aSiteId=#{pwInfo.aSiteId}
  </if>
  <if test="pwInfo.zSiteId > 0">
  and p.zSiteId=#{pwInfo.zSiteId}
  </if>
  <if test="pwInfo.tunnelId > 0">
  AND p.tunnelId=#{pwInfo.tunnelId}
  </if>
  <if test="pwInfo.pwStatus != 0">
  AND  p.pwStatus=#{pwInfo.pwStatus}
  </if>
  <if test="pwInfo.createUser != null and pwInfo.createUser != ''">
  AND  p.createUser=#{pwInfo.createUser}
  </if>
  <if test="pwInfo.pwName != null and pwInfo.pwName != ''">
  AND  p.pwName like "%"#{pwInfo.pwName}"%"
  </if>
  <if test="pwInfo.inLblMinValue != 0">
  AND p.inlabelValue &gt;= #{pwInfo.inLblMinValue}
  </if>
  <if test="pwInfo.inLblMaxValue != 0">
  AND p.inlabelValue &lt;= #{pwInfo.inLblMaxValue}
  </if>
  <if test="pwInfo.outLblMinValue != 0">
  AND p.outlabelValue &gt;= #{pwInfo.outLblMinValue}
  </if>
  <if test="pwInfo.outLblMaxValue != 0">
  AND p.outlabelValue &lt;= #{pwInfo.outLblMaxValue}
  </if>
  <if test="pwInfo.businessType != null and pwInfo.businessType != ''">
  AND p.businessType = #{pwInfo.businessType}
  </if>
  </select>
  <select id="queryByPwTunnelIdCondition" resultMap="BaseResultMap" parameterType="java.util.List">
  SELECT * FROM pwinfo WHERE tunnelId in
  <foreach item="item" index="index" collection="tunnelIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </select>
  <select id="queryFilte" resultMap="BaseResultMap" >
  SELECT p.qosModel,p.atp_id,p.ztp_id,p.businessType,p.backInlabel,p.backOutlabel,p.ztargetMac,p.zSourceMac,p.zOutVlanValue,
  p.zVlanEnable,p.atargetMac,p.aSourceMac,p.aOutVlanValue,p.aVlanEnable,p.expStrategy,p.expAssignment,p.phbToExpId,p.phbStrategy,
  p.phbAssignment,p.expTophbId,p.jobstatus,p.aoppositeId,p.zoppositeId,p.isSingle , p.pwId, p.pwName, p.pwStatus, p.tunnelId,
  p.aSiteId,p.zSiteId, p.type, p.inlabelValue, p.outlabelValue,p.apwServiceId,p.zpwServiceId,sa.CellId AS showaSiteName, 
  sz.CellId AS showzSiteName, p.direction, LEFT(p.createTime, 19) as createTime,p.createUser,p.rserviceId,p.rserviceType,p.aPortConfigId,p.zPortConfigId,
  p.payload FROM pwinfo p, site_inst sa, site_inst sz where 1=1 and p.aSiteId = sa.site_inst_id AND p.zSiteId = sz.site_inst_id 
  and p.tunnelId > 0 and p.isSingle=#{pwInfo.isSingle}
  <if test="pwInfo.aSiteId > 0">
  and (p.aSiteId = #{pwInfo.aSiteId} or p.zSiteId = #{pwInfo.aSiteId})
  </if>
  <if test="pwInfo.pwStatus > 0">
  AND  p.pwStatus=#{pwInfo.pwStatus}
  </if>
  <if test="pwInfo.pwName != null and pwInfo.pwName != ''">
  AND  p.pwName like "%"#{pwInfo.pwName}"%"
  </if>
  <if test="type > 0">
  AND p.type = #{type}
  </if>
  <if test="pwInfo.tunnelId > 0">
  AND p.tunnelId=#{pwInfo.tunnelId}
  </if>
  <if test="pwInfo.pwStatus != 0">
  AND  p.pwStatus=#{pwInfo.pwStatus}
  </if>
  <if test="pwInfo.createUser != null and pwInfo.createUser != ''">
  AND  p.createUser=#{pwInfo.createUser}
  </if>
  </select>
  <select id="selectByPWId" resultMap="BaseResultMap" parameterType="PwInfo">
  <if test="isSingle == 0">
	SELECT p.qosModel,p.atp_id,p.ztp_id,p.businessType,p.backInlabel,p.backOutlabel,p.ztargetMac,p.zSourceMac,p.zOutVlanValue,
  p.zVlanEnable,p.atargetMac,p.aSourceMac,p.aOutVlanValue,p.aVlanEnable,p.expStrategy,p.expAssignment,p.phbToExpId,p.phbStrategy,
  p.phbAssignment,p.expTophbId,p.jobstatus,p.aoppositeId,p.zoppositeId,p.isSingle , p.pwId, p.pwName, p.pwStatus, p.tunnelId,
  p.aSiteId,p.zSiteId, p.type, p.inlabelValue, p.outlabelValue,p.apwServiceId,p.zpwServiceId,sa.CellId AS showaSiteName, 
  sz.CellId AS showzSiteName, p.direction, p.createTime,p.createUser,p.rserviceId,p.rserviceType,p.aPortConfigId,p.zPortConfigId,
  p.payload FROM pwinfo p, site_inst sa, site_inst sz where 1=1 and p.aSiteId = sa.site_inst_id AND p.zSiteId = sz.site_inst_id
  and pwId=#{pwId}  
  </if>
  <if test="isSingle == 1">
  select * from pwinfo where pwId = #{pwId}
  </if>
  </select>
  <select id="queryPwBySiteIdAndIsSingle" resultMap="BaseResultMap" parameterType="PwInfo">
  SELECT p.qosModel,p.atp_id,p.ztp_id,p.businessType,p.backInlabel,p.backOutlabel,p.ztargetMac,p.zSourceMac,p.zOutVlanValue,
  p.zVlanEnable,p.atargetMac,p.aSourceMac,p.aOutVlanValue,p.aVlanEnable,p.expStrategy,p.expAssignment,p.phbToExpId,p.phbStrategy,
  p.phbAssignment,p.expTophbId,p.jobstatus,p.aoppositeId,p.zoppositeId,p.isSingle , p.pwId, p.pwName, p.pwStatus, p.tunnelId,
  p.aSiteId,p.zSiteId, p.type, p.inlabelValue, p.outlabelValue,p.apwServiceId,p.zpwServiceId,sa.CellId AS showaSiteName, 
  sz.CellId AS showzSiteName, p.direction, p.createTime,p.createUser,p.rserviceId,p.rserviceType,p.aPortConfigId,p.zPortConfigId,
  p.payload FROM pwinfo p, site_inst sa, site_inst sz where 1=1 and p.aSiteId = sa.site_inst_id AND p.zSiteId = sz.site_inst_id
  and isSingle=#{isSingle} and (aSiteId=#{aSiteId} or zSiteId=#{aSiteId})
  </select>
  <select id="queryByPwidCondition_notjoin" resultMap="BaseResultMap" parameterType="PwInfo">
  SELECT * from pwinfo where 1=1
  <if test="pwId > 0">
  and pwId=#{pwId}
  </if>
  <if test="pwName != null and pwName != ''">
  and pwName=#{pwName}
  </if>
  <if test="InlabelValue > 0">
  and inlabelValue=#{InlabelValue}
  </if>
  <if test="OutlabelValue > 0">
  and inlabelValue=#{OutlabelValue}
  </if>
  <if test="backInlabel > 0">
  and inlabelValue=#{backInlabel}
  </if>
  <if test="backOutlabel > 0">
  and inlabelValue=#{backOutlabel}
  </if>
  </select>
  <select id="findPwByIds" resultMap="BaseResultMap" parameterType="java.util.List">
  select * from pwinfo p where p.pwid in
  <foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </select>
  <select id="queryNode" resultMap="BaseResultMap" >
  select * from pwinfo p where (asiteId=#{pwInfo.aSiteId} or zsiteid=#{pwInfo.zSiteId}) 
   <if test="pwInfo.pwName != null and pwInfo.pwName != ''">
  AND  p.pwName like "%"#{pwInfo.pwName}"%"
  </if>
   <if test="type > 0">
  AND  p.type=#{type}
  </if>
   <if test="pwInfo.tunnelId > 0">
  AND  p.tunnelId=#{pwInfo.tunnelId}
  </if>
   <if test="pwInfo.pwStatus > 0">
  AND  p.pwStatus=#{pwInfo.pwStatus}
  </if>
   <if test="pwInfo.inLblMinValue > 0">
  AND p.inlabelValue &gt;=#{pwInfo.inLblMinValue}
  </if>
   <if test="pwInfo.inLblMaxValue > 0">
  AND p.inlabelValue &lt;=#{pwInfo.inLblMaxValue}
  </if>
   <if test="pwInfo.outLblMinValue > 0">
  AND p.outlabelValue &gt;=#{pwInfo.outLblMinValue}
  </if>
   <if test="pwInfo.outLblMaxValue > 0">
  AND p.outlabelValue &lt;=#{pwInfo.outLblMaxValue}
  </if>
  </select>
  <update id="updateServiceByPwId" >
  	update serviceinfo set pwId = #{newPwId} where pwId in
  	<foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </update>
  <update id="updatePwBuffByPwId" >
  	update pwnnibuffer set pwId = #{newPwId} where pwId in
  	<foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </update>
  <update id="updateQosRelevanceByPwId" >
  	update qosrelevance set objId = #{newPwId} where objType='PW' and objId in
  	<foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </update>
  <update id="updateOamMepByPwId" >
  	update oammepinfo set serviceId = #{newPwId} where objType='PW' and serviceId in
  	<foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </update>
  <update id="updateCurrAlarmByPwId" >
  	update current_alarm set objectid = #{newPwId} where objecttype=4 and objectid in
  	<foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </update>
  <update id="updateHisAlarmByPwId" >
  	update history_alarm set objectid = #{newPwId} where objecttype=4 and objectid in
  	<foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </update>
  <update id="updatePerformanceByPwId" >
  	update history_performance set objectid = #{newPwId} where objecttype=4 and objectid in
  	<foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </update>
  <delete id="deleteByPwIdList" parameterType="java.util.List">
  delete from pwinfo where pwid in
  <foreach item="item" index="index" collection="pwIdList" open="(" separator="," close=")">  
 	 #{item}  
 	</foreach>
  </delete>
  <select id="queryByTunnelId" resultMap="BaseResultMap" parameterType="java.lang.Integer">
  select * from pwinfo p where p.isSingle=0 and p.tunnelId =#{tunnelId}
  </select>
  <select id="selectSamePortByTunnelId" resultMap="BaseResultMap">
  select * from pwinfo p where p.tunnelId = #{0} and p.aSiteId = #{1} or p.zSiteId = #{1} 
  </select>
  <select id="query_synchro" resultMap="BaseResultMap">
  select * from pwinfo where ((asiteid=#{0} and apwServiceId=#{1}) or (zsiteid=#{0} and zpwServiceId=#{1})) and type=#{2}
  </select>
  <update id="update" >
    update pwinfo
    set pwName = #{pw.pwName,jdbcType=VARCHAR},
      pwStatus = #{pw.pwStatus,jdbcType=INTEGER},
      tunnelId = #{pw.tunnelId,jdbcType=INTEGER},
      inlabelValue = #{pw.InlabelValue,jdbcType=INTEGER},
      outlabelValue = #{pw.OutlabelValue,jdbcType=INTEGER},
      aSiteId = #{pw.aSiteId,jdbcType=INTEGER},
      zSiteId = #{pw.zSiteId,jdbcType=INTEGER},
      direction = #{pw.direction,jdbcType=VARCHAR},
      createTime = #{pw.createTime,jdbcType=TIMESTAMP},
      createUser = #{pw.createUser,jdbcType=VARCHAR},
      apwServiceId = #{pw.apwServiceId,jdbcType=INTEGER},
      zpwServiceId = #{pw.zpwServiceId,jdbcType=INTEGER},
      rserviceId = #{pw.relatedServiceId,jdbcType=INTEGER},
      rserviceType = #{pw.relatedServiceType,jdbcType=INTEGER},
      aPortConfigId = #{pw.aPortConfigId,jdbcType=INTEGER},
      zPortConfigId = #{pw.zPortConfigId,jdbcType=INTEGER},
      type = #{type,jdbcType=INTEGER},
      isSingle = #{pw.isSingle,jdbcType=INTEGER},
      aoppositeId = #{pw.aoppositeId,jdbcType=VARCHAR},
      zoppositeId = #{pw.zoppositeId,jdbcType=VARCHAR},
      jobstatus = #{pw.jobStatus,jdbcType=VARCHAR},
      expStrategy = #{pw.expStrategy,jdbcType=INTEGER},
      expAssignment = #{pw.expAssignment,jdbcType=INTEGER},
      phbToExpId = #{pw.phbToExpId,jdbcType=INTEGER},
      phbStrategy = #{pw.phbStrategy,jdbcType=INTEGER},
      phbAssignment = #{pw.phbAssignment,jdbcType=INTEGER},
      expTophbId = #{pw.expTophbId,jdbcType=INTEGER},
      payload = #{pw.payload,jdbcType=INTEGER},
      aVlanEnable = #{pw.aVlanEnable,jdbcType=INTEGER},
      aOutVlanValue = #{pw.aOutVlanValue,jdbcType=INTEGER},
      aSourceMac = #{pw.aSourceMac,jdbcType=VARCHAR},
      atargetMac = #{pw.atargetMac,jdbcType=VARCHAR},
      zVlanEnable = #{pw.zVlanEnable,jdbcType=INTEGER},
      zOutVlanValue = #{pw.zOutVlanValue,jdbcType=INTEGER},
      zSourceMac = #{pw.zSourceMac,jdbcType=VARCHAR},
      ztargetMac = #{pw.ztargetMac,jdbcType=VARCHAR},
      businessType = #{pw.businessType,jdbcType=VARCHAR},
      backInlabel = #{pw.backInlabel,jdbcType=INTEGER},
      backOutlabel = #{pw.backOutlabel,jdbcType=INTEGER},
      atp_id = #{pw.atp_id,jdbcType=INTEGER},
      ztp_id = #{pw.ztp_id,jdbcType=INTEGER},
      qosModel = #{pw.qosModel,jdbcType=INTEGER}
    where pwId = #{pw.pwId,jdbcType=INTEGER}
  </update>
  <select id="queryBySiteId" resultMap="BaseResultMap" parameterType="java.lang.Integer">
  	select * from pwinfo p where p.issingle=0 and (aSiteId=#{0} or zSiteId=#{0})
  </select>
  <insert id="doSearch" >
  INSERT INTO pwinfo ( pwName, pwStatus, tunnelId, inlabelValue, outlabelValue, aSiteId, zSiteId, direction, createTime, 
  createUser, apwServiceId, zpwServiceId, rserviceId, rserviceType, aPortConfigId, zPortConfigId, type, isSingle, aoppositeId, 
  zoppositeId, jobstatus, expStrategy, expAssignment, phbToExpId, phbStrategy, phbAssignment, expTophbId, payload,qosModel,
  businessType,snmpPwName ) SELECT #{0}, a.pwStatus, a.tunnelId, b.inlabelValue, b.outlabelValue, a.aSiteId, b.zSiteId, a.direction,
   now() createTime, a.createUser, a.apwServiceId, b.zpwServiceId, a.rserviceId, a.rserviceType, a.aPortConfigId, b.zPortConfigId,
    a.type, 0, a.aoppositeId, b.zoppositeId, a.jobstatus, a.expStrategy, a.expAssignment, a.phbToExpId, a.phbStrategy, a.phbAssignment, 
    a.expTophbId, a.payload,a.qosModel ,0 ,a.snmpPwName FROM pwinfo a, pwinfo b WHERE a.pwId = #{1} AND b.pwId = #{2}
  </insert>
  <select id="queryPwIdByName" resultType="java.lang.Integer" parameterType="java.lang.String">
  select pwId from pwinfo where pwName=#{0}
  </select>
  <update id="setUser">
  update pwinfo set rserviceId=#{1},rserviceType=#{2} where pwId=#{0}
  </update>
 <select id="queryBySiteAndServiceId" resultMap="BaseResultMap" parameterType="map">
  select * from pwInfo where  (asiteid=#{siteId} and apwServiceId=#{serviceId}) or (zsiteid=#{siteId} and zpwServiceId=#{serviceId})
 </select>
 <select id="query_name" resultType="java.lang.Integer">
 select count(*) from pwinfo where pwName=#{afterName}
 <if test="beforeName != null">
 and pwName!=#{beforeName}
 </if>
 </select>
 <select id="query_nameBySingle" resultType="java.lang.Integer">
 select count(*) from pwinfo where (aSiteId = #{siteId} or zSiteId = #{siteId}) and pwName=#{afterName}
 <if test="beforeName != null">
 and pwName!=#{beforeName}
 </if>
 </select>
  <select id="queryNotEth" resultMap="BaseResultMap" parameterType="PwInfo">
  SELECT * from pwinfo WHERE type!=1 
  <if test="aSiteId>0"> and (asiteid=#{aSiteId} or zsiteid=#{aSiteId})</if>
	 and issingle=#{isSingle}		
  </select>
  <select id="queryByType" resultMap="BaseResultMap" >
  SELECT * FROM pwinfo WHERE 1=1
  <if test="type > 0">
  and type=#{type}
  </if>
  <if test="pwInfo.aSiteId > 0">
  and (asiteid=#{pwInfo.aSiteId} or zsiteid=#{pwInfo.aSiteId})
  </if>
  and isSingle = #{pwInfo.isSingle}
  </select>
</mapper>