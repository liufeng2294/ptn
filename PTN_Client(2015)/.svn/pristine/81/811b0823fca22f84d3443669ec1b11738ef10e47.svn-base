package com.nms.model.system;

import java.sql.Connection;
import java.util.List;

import com.nms.db.bean.equipment.shelf.SiteInst;
import com.nms.db.bean.system.OffLinesiteBusi;
import com.nms.db.dao.system.OffLinesiteBusiDao;
import com.nms.db.enums.EActionType;
import com.nms.model.util.ObjectService;
/**
 * 离线网元业务下载Service
 * @author Dzy
 *
 */
public class OffLinesiteBusiService extends ObjectService{
	OffLinesiteBusiDao offLinesiteBusiDao = new OffLinesiteBusiDao();
	public void setConnection(Connection connection) {
		super.connection = connection;
	}

	public void setPtnuser(String ptnuser) {
		super.ptnuser = ptnuser;
	}
	/**
	 * 搜索条件网元下 离线网元业务数据
	 * @param siteInstList 网元集合
	 * @return
	 * @throws Exception
	 */
	public List<OffLinesiteBusi> selectBySiteIds(List<SiteInst> siteInstList) throws Exception {
		return offLinesiteBusiDao.selectBySiteIds(siteInstList,connection);
	}
	public List<OffLinesiteBusi> selectByCondition(OffLinesiteBusi offLinesiteBusi) throws Exception {
		return offLinesiteBusiDao.selectByCondition(offLinesiteBusi,connection);
	}
	public int delete(OffLinesiteBusi offLinesiteBusi) throws Exception{
		return offLinesiteBusiDao.delete(offLinesiteBusi, connection);
	}
	
	
	public int dataDownLoadAction(OffLinesiteBusi condition) throws Exception{
		int result = 0 ;
		List<OffLinesiteBusi> list = this.selectByCondition(condition);
		if(list.size()==0){
			result = offLinesiteBusiDao.insert(condition,connection);
		}else{
			OffLinesiteBusi offLinesiteBusi = list.get(0);
			if(EActionType.UPDATE.getValue() == condition.getAction()){
				/*condition.setAction(offLinesiteBusi.getAction());
				return result = offLinesiteBusiDao.update(condition,connection);*/
			}else if(EActionType.DELETE.getValue() == condition.getAction()){
				if(list.get(0).getAction()==EActionType.INSERT.getValue()){
					return result = offLinesiteBusiDao.delete(offLinesiteBusi, connection);
				}else{
					result = offLinesiteBusiDao.update(condition,connection);
				}
			}
		}
		return result;
		
	}
}
